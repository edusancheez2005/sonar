(()=>{var e={};e.id=925,e.ids=[925],e.modules={9608:e=>{function s(e){var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}s.keys=()=>[],s.resolve=s,s.id=9608,e.exports=s},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},2789:(e,s,t)=>{"use strict";t.r(s),t.d(s,{originalPathname:()=>b,patchFetch:()=>S,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>x});var r={};t.r(r),t.d(r,{POST:()=>c});var o=t(9303),i=t(8716),n=t(670),u=t(7070),a=t(7574);let p=new Map;async function c(e){let s;let t=e.headers.get("x-forwarded-for")?.split(",")[0]?.trim()||"127.0.0.1";if(!function(e,s=6e4,t=10){let r=Date.now(),o=p.get(e);return!o||r-o.ts>s?(p.set(e,{count:1,ts:r}),!0):!(o.count>=t)&&(o.count++,!0)}(t))return u.NextResponse.json({error:"Too many requests"},{status:429});if(!process.env.SUPABASE_URL||!process.env.SUPABASE_SERVICE_ROLE)return u.NextResponse.json({error:"Service not configured"},{status:503});try{s=await e.json()}catch{return u.NextResponse.json({error:"Invalid JSON"},{status:400})}let r=String(s?.email||"").trim().toLowerCase();if(!r||r.length>254||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))return u.NextResponse.json({error:"Invalid email"},{status:400});let{data:o,error:i}=await a.p.from("emails").insert([{email:r,ip:t}]).select().single();return i?String(i.message).toLowerCase().includes("duplicate")?u.NextResponse.json({ok:!0,message:"Already subscribed"}):u.NextResponse.json({error:"Failed to subscribe"},{status:500}):u.NextResponse.json({ok:!0,message:"Subscribed",id:o?.id})}let d=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/subscribe/route",pathname:"/api/subscribe",filename:"route",bundlePath:"app/api/subscribe/route"},resolvedPagePath:"/Users/edusanchez/sonar/app/api/subscribe/route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:x,serverHooks:m}=d,b="/api/subscribe/route";function S(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:x})}},7574:(e,s,t)=>{"use strict";t.d(s,{p:()=>r});let r=(0,t(9498).eI)(process.env.SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE,{auth:{persistSession:!1}})}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[948,498,972],()=>t(2789));module.exports=r})();