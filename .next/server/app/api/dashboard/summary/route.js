(()=>{var e={};e.id=940,e.ids=[940],e.modules={9608:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=9608,e.exports=t},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},5961:(e,t,s)=>{"use strict";s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>_,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>d,staticGenerationAsyncStorage:()=>m});var r={};s.r(r),s.d(r,{GET:()=>l});var a=s(9303),o=s(8716),n=s(670),i=s(7070),u=s(7574);async function l(){if(!process.env.SUPABASE_URL||!process.env.SUPABASE_SERVICE_ROLE)return i.NextResponse.json({error:"Supabase env vars not set"},{status:503});let{data:e,error:t}=await u.p.from("whale_transactions").select("transaction_hash, timestamp, token_symbol, classification, blockchain, usd_value, from_address").not("token_symbol","is",null).not("token_symbol","ilike","unknown%").order("timestamp",{ascending:!1}).limit(20);if(t)return i.NextResponse.json({error:t.message},{status:500});let s=(e||[]).map(e=>({transaction_hash:e.transaction_hash,time:e.timestamp,coin:e.token_symbol,action:(e.classification||"").toUpperCase(),blockchain:e.blockchain,usd_value:Number(e.usd_value||0),from_address:e.from_address||null})),{data:r}=await u.p.from("whale_transactions").select("token_symbol, classification, usd_value, blockchain").not("token_symbol","is",null).not("token_symbol","ilike","unknown%").order("timestamp",{ascending:!1}).limit(500),a=new Map,o=new Map,n=new Map,l=new Map;for(let e of r||[]){let t=e.token_symbol||"—",s=e.blockchain||"—";l.set(s,(l.get(s)||0)+1);let r=(e.classification||"").toLowerCase();"buy"===r?o.set(t,(o.get(t)||0)+1):"sell"===r&&n.set(t,(n.get(t)||0)+1),a.set(t,(a.get(t)||0)+1)}function p(e){let t=Array.from(e.entries()).map(([e,t])=>{let s=a.get(e)||1;return{coin:e,percentage:Number((t/s*100).toFixed(1))}});return t.sort((e,t)=>t.percentage-e.percentage),t.slice(0,10)}let c=p(o),m=p(n),d={labels:Array.from(l.keys()),data:Array.from(l.values())};return i.NextResponse.json({recent:s,topBuys:c,topSells:m,blockchainVolume:d})}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/dashboard/summary/route",pathname:"/api/dashboard/summary",filename:"route",bundlePath:"app/api/dashboard/summary/route"},resolvedPagePath:"/Users/edusanchez/sonar/app/api/dashboard/summary/route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:m,serverHooks:d}=p,h="/api/dashboard/summary/route";function _(){return(0,n.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:m})}},7574:(e,t,s)=>{"use strict";s.d(t,{p:()=>r});let r=(0,s(9498).eI)(process.env.SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE,{auth:{persistSession:!1}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,498,972],()=>s(5961));module.exports=r})();