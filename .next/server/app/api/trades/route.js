(()=>{var e={};e.id=258,e.ids=[258],e.modules={9608:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=9608,e.exports=t},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},5563:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{GET:()=>p});var i=r(9303),o=r(8716),a=r(670),n=r(7070),u=r(7574);async function p(e){if(!process.env.SUPABASE_URL||!process.env.SUPABASE_SERVICE_ROLE)return n.NextResponse.json({error:"Supabase env vars not set"},{status:503});let{searchParams:t}=new URL(e.url),r=Number(t.get("sinceHours")||"24"),s=t.get("minUsd"),i=t.get("maxUsd"),o=(t.get("token")||"").trim(),a=(t.get("side")||"").trim().toLowerCase(),p=(t.get("chain")||"").trim(),l=Math.max(1,parseInt(t.get("page")||"1",10)),c=Math.min(Math.max(1,parseInt(t.get("limit")||"200",10)),200),d=(l-1)*c,m=u.p.from("whale_transactions").select("transaction_hash,timestamp,blockchain,token_symbol,classification,usd_value,from_address,whale_score",{count:"estimated"}).not("token_symbol","is",null).not("token_symbol","ilike","unknown%");if(!Number.isNaN(r)&&r>0){let e=new Date(Date.now()-36e5*r).toISOString();m=m.gte("timestamp",e)}let h=null===s||""===s?void 0:Number(s),g=null===i||""===i?void 0:Number(i);"number"!=typeof h||Number.isNaN(h)||(m=m.gte("usd_value",h)),"number"!=typeof g||Number.isNaN(g)||(m=m.lte("usd_value",g)),o&&(m=m.ilike("token_symbol",`%${o}%`)),a&&(m=m.ilike("classification",a)),p&&(m=m.ilike("blockchain",`%${p}%`));let{data:v,error:x,count:_}=await m.order("timestamp",{ascending:!1}).range(d,d+c-1);return x?n.NextResponse.json({error:x.message},{status:500}):n.NextResponse.json({data:v,page:l,limit:c,count:_})}let l=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/trades/route",pathname:"/api/trades",filename:"route",bundlePath:"app/api/trades/route"},resolvedPagePath:"/Users/edusanchez/sonar/app/api/trades/route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:m}=l,h="/api/trades/route";function g(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},7574:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});let s=(0,r(9498).eI)(process.env.SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE,{auth:{persistSession:!1}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,498,972],()=>r(5563));module.exports=s})();